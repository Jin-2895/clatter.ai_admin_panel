import{d as l,j as a,V as P,W as _,X as k,Y as E,Z as O,$ as R,a0 as y,h as G,r,i as K,au as v,C as w,e as D,a2 as U,l as B,R as L,m as b,O as A,s as T,P as j}from"./index.c8bb1a37.js";import{S as F}from"./react-select.esm.69af930a.js";import{Q as ee,C as ae,R as te}from"./react-dataTable-component.65fa3c69.js";import{m as M}from"./moment.45f3d69c.js";import{M as le,F as z,u as se,h as ne}from"./useQueryParams.f267746c.js";import{s as re,S as ie}from"./startCsvDownload.a895920d.js";const oe=e=>{var h;if((h=e==null?void 0:e.avatar)!=null&&h.length)return a(y,{className:"me-1",img:e.avatar,width:"32",height:"32"});{let f=e.firstName+" "+e.lastName;return a(y,{initials:!0,className:"me-1",color:e.avatarColor||"light-primary",content:f||"John Doe"})}},ce={active:"light-success",deactivated:"light-warning",inactive:"light-secondary",banned:"light-danger"},me=[{name:"User",sortable:!0,minWidth:"300px",sortField:"fullName",selector:e=>e.firstName+e.lastName,cell:e=>l("div",{className:"d-flex justify-content-left align-items-center",children:[oe(e),l("div",{className:"d-flex flex-column",children:[a(P,{to:`/user/view/${e.userId}`,className:"user_name text-truncate text-body",children:l("span",{className:"fw-bolder text-capitalize",children:[e.firstName," ",e.lastName]})}),a("small",{className:"text-truncate text-muted mb-0",children:e.email})]})]})},{name:"Plan",minWidth:"135px",sortable:!0,sortField:"planName",selector:e=>e.planName,cell:e=>a("span",{className:"text-capitalize",children:e.planName})},{name:"Amount",minWidth:"135px",sortable:!0,sortField:"planAmount",selector:e=>e.planAmount,cell:e=>l("span",{className:"text-capitalize",children:["$",e.planAmount]})},{name:"Status",minWidth:"140px",sortable:!0,sortField:"subscription",selector:e=>e.subscriptionStatus,cell:e=>a(_,{className:"text-capitalize d-flex flex-column",color:ce[e.subscriptionStatus],pill:!0,children:a("span",{className:"text-capitalize",children:e.subscriptionStatus})})},{name:"Created At",minWidth:"140px",sortable:!0,sortField:"createdAt",selector:e=>e.createdAt,cell:e=>l("div",{className:"text-capitalize d-flex flex-column",children:[a("span",{children:M(e.createdAt).format("DD/MM/YY")}),a("smal",{children:M(e.createdAt).format("hh:mm A")})]})},{name:"Actions",minWidth:"100px",cell:e=>a("div",{className:"column-action",children:l(k,{children:[a(E,{tag:"div",className:"btn btn-sm",children:a(le,{size:14,className:"cursor-pointer"})}),a(O,{children:l(R,{tag:P,className:"w-100",to:`/user/view/${e.id}`,children:[a(z,{size:14,className:"me-50"}),a("span",{className:"align-middle",children:"Details"})]})})]})})}],de=({handlePerPage:e,rowsPerPage:h,handleFilter:f,searchTerm:o,handleDownloadCSV:x})=>a("div",{className:"invoice-list-table-header w-100 me-1 ms-50 mt-2 mb-75",children:l(L,{children:[a(b,{xl:"6",className:"d-flex align-items-center p-0",children:l("div",{className:"d-flex align-items-center w-100",children:[a("label",{htmlFor:"rows-per-page",children:"Show"}),l(j,{className:"mx-50",type:"select",id:"rows-per-page",value:h,onChange:e,style:{width:"5rem"},children:[a("option",{value:"10",children:"10"}),a("option",{value:"25",children:"25"}),a("option",{value:"50",children:"50"})]}),a("label",{htmlFor:"rows-per-page",children:"Entries"})]})}),l(b,{xl:"6",className:"d-flex align-items-sm-center justify-content-xl-end justify-content-start flex-xl-nowrap flex-wrap flex-sm-row flex-column pe-xl-1 p-0 mt-xl-0 mt-1",children:[l("div",{className:"d-flex align-items-center mb-sm-0 mb-1 me-1",children:[a("label",{className:"mb-0",htmlFor:"search-invoice",children:"Search:"}),a(j,{id:"search-invoice",className:"ms-50 w-100",type:"text",value:o,onChange:c=>f(c.target.value)})]}),a("div",{className:"d-flex align-items-center table-header-actions",children:l(k,{className:"me-1",children:[l(E,{color:"secondary",caret:!0,outline:!0,children:[a(ie,{className:"font-small-4 me-50"}),a("span",{className:"align-middle",children:"Export"})]}),a(O,{children:l(R,{className:"w-100",onClick:()=>x(),children:[a(z,{className:"font-small-4 me-50"}),a("span",{className:"align-middle",children:"CSV"})]})})]})})]})]})}),ye=()=>{const e=G(),[h,f]=r.exports.useState("desc"),[o,x]=r.exports.useState(""),[c,g]=r.exports.useState(1),[ue,W]=r.exports.useState("id");r.exports.useState(!1);const[d,$]=r.exports.useState(10),[i,I]=r.exports.useState(null),[H,V]=r.exports.useState(null),[u,N]=r.exports.useState({value:"",label:"All"}),[p,C]=r.exports.useState({value:"",label:"All"}),{adminBillingData:s}=K(t=>t.subscription);r.exports.useEffect(()=>{s&&(I(s==null?void 0:s.data),V(s==null?void 0:s.totalSubscriptions))},[s]);const q=()=>{let t={page:c,plan:p.value,status:u.value,keyword:o,limit:d,flag:"getCSVOfTransactions"},n={};Object.keys(t).forEach(m=>{t[m]!==void 0&&t[m]!==null&&(n[m]=t[m])}),e(v(n))};r.exports.useEffect(()=>{(s==null?void 0:s.url)!==null&&(s==null?void 0:s.url)!==void 0&&re(s==null?void 0:s.url)},[s]),r.exports.useEffect(()=>{const n={...{page:c,plan:p.value,status:u.value,keyword:o,limit:d}};se(n);const m=ne(n);return window.addEventListener("popstate",m),()=>{window.removeEventListener("popstate",m)}},[c,p,u,o,d]),r.exports.useEffect(()=>{let t,n={page:c,plan:p.value,status:u.value,keyword:o,limit:d};return o?t=setTimeout(()=>{e(v(n))},1500):t=setTimeout(()=>{e(v(n))},100),i&&(t=setTimeout(()=>{e(v(n))},1e3)),()=>{clearTimeout(t)}},[e,c,p,u,d,o]),r.exports.useEffect(()=>{g(1)},[p,u,o]);const Q=[{value:"",label:"All"},{value:"active",label:"Active"},{value:"cancel",label:"Cancelled"},{value:"expired",label:"Expired"}],Y=[{value:"",label:"All"},{value:"Creator Monthly Plan",label:"Creator Monthly Plan"},{value:"Agency Monthly Plan",label:"Agency Monthly Plan"},{value:"Company Monthly Plan",label:"Company Monthly Plan"},{value:"Free Trial",label:"Free Trial"}],J=t=>{g(t.selected+1)},X=t=>{const n=parseInt(t.currentTarget.value);$(n)},Z=t=>{x(t)};return l("div",{className:"app-user-list",children:[l(w,{children:[a(D,{children:a(U,{tag:"h4",children:"Filters"})}),a(B,{children:l(L,{children:[l(b,{md:"4",children:[a(A,{for:"role-select",children:"Subscription Status"}),a(F,{isClearable:!1,value:u||"",options:Q,className:"react-select",classNamePrefix:"select",theme:T,onChange:t=>{!t||(t.value!==""&&t.label?N({label:t.label,value:t.value}):N({label:t.label,value:t.value}))}})]}),l(b,{className:"my-md-0 my-1",md:"4",children:[a(A,{for:"plan-select",children:"Plan"}),a(F,{theme:T,isClearable:!1,className:"react-select",classNamePrefix:"select",options:Y,value:p||"",onChange:t=>{!t||(t.value!==""&&t.label?C({label:t.label,value:t.value}):C({label:t.label,value:t.value}))}})]})]})})]}),a(w,{className:"overflow-hidden",children:a("div",{className:"react-dataTable",children:a(ee,{noHeader:!0,subHeader:!0,sortServer:!0,pagination:!0,responsive:!0,paginationServer:!0,columns:me,onSort:(t,n)=>{f(n),W(t.sortField)},sortIcon:a(ae,{}),className:"react-dataTable",paginationComponent:()=>{const t=Number(Math.ceil(H/d));return a(te,{previousLabel:"",nextLabel:"",pageCount:t||1,activeClassName:"active",forcePage:c!==0?c-1:0,onPageChange:n=>J(n),pageClassName:"page-item",nextLinkClassName:"page-link",nextClassName:"page-item next",previousClassName:"page-item prev",previousLinkClassName:"page-link",pageLinkClassName:"page-link",containerClassName:"pagination react-paginate justify-content-end my-2 pe-1"})},data:(()=>{const t={role:u.value,currentPlan:p.value},n=Object.keys(t).some(function(m){var S;return((S=t[m])==null?void 0:S.length)>0});return(i==null?void 0:i.length)>0&&!n?i:(i==null?void 0:i.length)===0&&n?[]:i==null?void 0:i.slice(0,d)})(),subHeaderComponent:a(de,{handleDownloadCSV:q,store:i,searchTerm:o,rowsPerPage:d,handleFilter:Z,handlePerPage:X})})})})]})};export{ye as default};
