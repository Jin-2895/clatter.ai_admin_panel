import{d as l,j as e,V as P,W as Z,X as k,Y as E,Z as O,$ as R,a0 as y,h as _,r,i as G,au as v,C as w,e as K,a2 as U,l as B,R as L,m as x,O as T,s as j,P as F}from"./index.c8bb1a37.js";import{S as A}from"./react-select.esm.69af930a.js";import{Q as ee,C as te,R as ae}from"./react-dataTable-component.65fa3c69.js";import{m as M}from"./moment.45f3d69c.js";import{M as le,F as W,u as se,h as ne}from"./useQueryParams.f267746c.js";import{s as re,S as ie}from"./startCsvDownload.a895920d.js";const oe=t=>{var h;if((h=t==null?void 0:t.avatar)!=null&&h.length)return e(y,{className:"me-1",img:t.avatar,width:"32",height:"32"});{let f=t.firstName+" "+t.lastName;return e(y,{initials:!0,className:"me-1",color:t.avatarColor||"light-primary",content:f||"John Doe"})}},ce={active:"light-success",deactivated:"light-warning",inactive:"light-secondary",banned:"light-danger"},me=[{name:"User",sortable:!0,minWidth:"300px",sortField:"fullName",selector:t=>t.firstName+t.lastName,cell:t=>l("div",{className:"d-flex justify-content-left align-items-center",children:[oe(t),l("div",{className:"d-flex flex-column",children:[e(P,{to:`/user/view/${t.userId}`,className:"user_name text-truncate text-body",children:l("span",{className:"fw-bolder text-capitalize",children:[t.firstName," ",t.lastName]})}),e("small",{className:"text-truncate text-muted mb-0",children:t.email})]})]})},{name:"Status",sortable:!0,minWidth:"130px",sortField:"Status",selector:t=>t.subscriptionStatus,cell:t=>e(Z,{className:"text-capitalize d-flex flex-column",color:ce[t.subscriptionStatus],pill:!0,children:e("span",{className:"text-capitalize",children:t.subscriptionStatus})})},{name:"Plan",minWidth:"135px",sortable:!0,sortField:"planName",selector:t=>t.planName,cell:t=>e("span",{className:"text-capitalize",children:t.planName})},{name:"Plan Credit",minWidth:"140px",sortable:!0,sortField:"createdAt",selector:t=>t.planCredit,cell:t=>e("span",{children:t.planCredit})},{name:"Created At",minWidth:"140px",sortable:!0,sortField:"createAt",selector:t=>t.subscriptionCreationDate,cell:t=>l("div",{className:"text-capitalize d-flex flex-column",children:[e("span",{children:M(t.subscriptionCreationDate).format("DD/MM/YY")}),e("smal",{children:M(t.subscriptionCreationDate).format("hh:mm A")})]})},{name:"Actions",minWidth:"100px",cell:t=>e("div",{className:"column-action",children:l(k,{children:[e(E,{tag:"div",className:"btn btn-sm",children:e(le,{size:14,className:"cursor-pointer"})}),e(O,{children:l(R,{tag:P,className:"w-100",to:`/user/view/${t.userId}`,children:[e(W,{size:14,className:"me-50"}),e("span",{className:"align-middle",children:"Details"})]})})]})})}],de=({store:t,handlePerPage:h,rowsPerPage:f,handleFilter:o,searchTerm:g,handleDownloadCSV:c})=>e("div",{className:"invoice-list-table-header w-100 me-1 ms-50 mt-2 mb-75",children:l(L,{children:[e(x,{xl:"6",className:"d-flex align-items-center p-0",children:l("div",{className:"d-flex align-items-center w-100",children:[e("label",{htmlFor:"rows-per-page",children:"Show"}),l(F,{className:"mx-50",type:"select",id:"rows-per-page",value:f,onChange:h,style:{width:"5rem"},children:[e("option",{value:"10",children:"10"}),e("option",{value:"25",children:"25"}),e("option",{value:"50",children:"50"})]}),e("label",{htmlFor:"rows-per-page",children:"Entries"})]})}),l(x,{xl:"6",className:"d-flex align-items-sm-center justify-content-xl-end justify-content-start flex-xl-nowrap flex-wrap flex-sm-row flex-column pe-xl-1 p-0 mt-xl-0 mt-1",children:[l("div",{className:"d-flex align-items-center mb-sm-0 mb-1 me-1",children:[e("label",{className:"mb-0",htmlFor:"search-invoice",children:"Search:"}),e(F,{id:"search-invoice",className:"ms-50 w-100",type:"text",value:g,onChange:b=>o(b.target.value)})]}),e("div",{className:"d-flex align-items-center table-header-actions",children:l(k,{className:"me-1",children:[l(E,{color:"secondary",caret:!0,outline:!0,children:[e(ie,{className:"font-small-4 me-50"}),e("span",{className:"align-middle",children:"Export"})]}),e(O,{children:l(R,{className:"w-100",onClick:()=>c(),children:[e(W,{className:"font-small-4 me-50"}),e("span",{className:"align-middle",children:"CSV"})]})})]})})]})]})}),ye=()=>{const t=_();r.exports.useState();const[h,f]=r.exports.useState("desc"),[o,g]=r.exports.useState(""),[c,b]=r.exports.useState(1),[ue,z]=r.exports.useState("id");r.exports.useState(!1);const[d,I]=r.exports.useState(10),[i,$]=r.exports.useState(null),[H,V]=r.exports.useState(null),[u,N]=r.exports.useState({value:"",label:"All"}),[p,C]=r.exports.useState({value:"",label:"All"}),{adminBillingData:s}=G(a=>a.subscription);r.exports.useEffect(()=>{s&&($(s==null?void 0:s.data),V(s==null?void 0:s.totalSubscriptions))},[s]);const q=()=>{let a={page:c,plan:p.value,status:u.value,keyword:o,limit:d,flag:"getCSVOfSubscriptions"},n={};Object.keys(a).forEach(m=>{a[m]!==void 0&&a[m]!==null&&(n[m]=a[m])}),t(v(n))};r.exports.useEffect(()=>{(s==null?void 0:s.url)!==null&&(s==null?void 0:s.url)!==void 0&&re(s==null?void 0:s.url)},[s]),r.exports.useEffect(()=>{const n={...{page:c,plan:p.value,status:u.value,keyword:o,limit:d}};se(n);const m=ne(n);return window.addEventListener("popstate",m),()=>{window.removeEventListener("popstate",m)}},[c,p,u,o,d]),r.exports.useEffect(()=>{let a,n={page:c,plan:p.value,status:u.value,keyword:o,limit:d};return o?a=setTimeout(()=>{t(v(n))},1500):a=setTimeout(()=>{t(v(n))},100),i&&(a=setTimeout(()=>{t(v(n))},1e3)),()=>{clearTimeout(a)}},[t,c,p,u,d,o]),r.exports.useEffect(()=>{b(1)},[p,u,o]);const Q=[{value:"",label:"All"},{value:"active",label:"Active"},{value:"cancel",label:"Cancelled"},{value:"expired",label:"Expired"}],Y=[{value:"",label:"All"},{value:"Creator Monthly Plan",label:"Creator Monthly Plan"},{value:"Agency Monthly Plan",label:"Agency Monthly Plan"},{value:"Company Monthly Plan",label:"Company Monthly Plan"},{value:"Free Trial",label:"Free Trial"}],D=a=>{b(a.selected+1)},J=a=>{const n=parseInt(a.currentTarget.value);I(n)},X=a=>{g(a)};return l("div",{className:"app-user-list",children:[l(w,{children:[e(K,{children:e(U,{tag:"h4",children:"Filters"})}),e(B,{children:l(L,{children:[l(x,{md:"4",children:[e(T,{for:"role-select",children:"Subscription Status"}),e(A,{isClearable:!1,value:u||"",options:Q,className:"react-select",classNamePrefix:"select",theme:j,onChange:a=>{!a||(a.value!==""&&a.label?N({label:a.label,value:a.value}):N({label:a.label,value:a.value}))}})]}),l(x,{className:"my-md-0 my-1",md:"4",children:[e(T,{for:"plan-select",children:"Plan"}),e(A,{theme:j,isClearable:!1,className:"react-select",classNamePrefix:"select",options:Y,value:p||"",onChange:a=>{!a||(a.value!==""&&a.label?C({label:a.label,value:a.value}):C({label:a.label,value:a.value}))}})]})]})})]}),e(w,{className:"overflow-hidden",children:e("div",{className:"react-dataTable",children:e(ee,{noHeader:!0,subHeader:!0,sortServer:!0,pagination:!0,responsive:!0,paginationServer:!0,columns:me,onSort:(a,n)=>{f(n),z(a.sortField)},sortIcon:e(te,{}),className:"react-dataTable",paginationComponent:()=>{const a=Number(Math.ceil(H/d));return e(ae,{previousLabel:"",nextLabel:"",pageCount:a||1,activeClassName:"active",forcePage:c!==0?c-1:0,onPageChange:n=>D(n),pageClassName:"page-item",nextLinkClassName:"page-link",nextClassName:"page-item next",previousClassName:"page-item prev",previousLinkClassName:"page-link",pageLinkClassName:"page-link",containerClassName:"pagination react-paginate justify-content-end my-2 pe-1"})},data:(()=>{const a={role:u.value,currentPlan:p.value},n=Object.keys(a).some(function(m){var S;return((S=a[m])==null?void 0:S.length)>0});return(i==null?void 0:i.length)>0&&!n?i:(i==null?void 0:i.length)===0&&n?[]:i==null?void 0:i.slice(0,d)})(),subHeaderComponent:e(de,{handleDownloadCSV:q,store:i,searchTerm:o,rowsPerPage:d,handleFilter:X,handlePerPage:J})})})})]})};export{ye as default};
